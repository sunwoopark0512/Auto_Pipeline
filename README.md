# Auto Pipeline

This repository contains scripts that automate keyword collection, hook generation with GPT, and uploading results to Notion. The pipeline is intended for marketing workflows where trending keywords are gathered, short hooks are generated, and the data is stored in Notion databases. Additional helpers retry failed uploads and update a KPI dashboard.

## Required Environment Variables

Create a `.env` file or export the following variables before running the scripts:

- `OPENAI_API_KEY` – API key used by `hook_generator.py` for GPT requests.
- `NOTION_API_TOKEN` – token for the Notion API.
- `NOTION_DB_ID` – Notion database for storing raw keyword metrics.
- `NOTION_HOOK_DB_ID` – database where generated hooks are uploaded.
- `NOTION_KPI_DB_ID` – database used by the KPI notifier.
- `KEYWORD_OUTPUT_PATH` – path for the keyword JSON (default `data/keyword_output_with_cpc.json`).
- `HOOK_OUTPUT_PATH` – path where hooks generated by GPT are stored (default `data/generated_hooks.json`).
- `FAILED_HOOK_PATH` – file used to log hooks that failed to generate.
- `REPARSED_OUTPUT_PATH` – JSON file of failed items that are retried.
- `UPLOADED_CACHE_PATH` – cache of successfully uploaded keywords.
- `FAILED_UPLOADS_PATH` – log of failed keyword uploads.
- `API_DELAY`, `UPLOAD_DELAY`, `RETRY_DELAY` – optional sleep delays (seconds) between API calls.
- `TOPIC_CHANNELS_PATH` – JSON file describing the topics to collect.

Only the variables relevant to the scripts you run are required, but the above list covers all available settings.

## Installing Dependencies

Use Python 3.10 or newer. Install dependencies with pip:

```bash
python -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
```

## Running the Pipeline

1. Ensure the environment variables are configured.
2. Run the main pipeline script:

```bash
python run_pipeline.py
```

The `run_pipeline.py` script sequentially executes the helper scripts (hook generation, retries and dashboard updates). You can also run individual components if needed:

```bash
python keyword_auto_pipeline.py          # collect trending keywords
python hook_generator.py                 # generate hooks using GPT
python notion_hook_uploader.py           # upload hooks to Notion
python retry_failed_uploads.py           # retry failed uploads
python retry_dashboard_notifier.py       # update KPI dashboard
```

The output JSON files will be placed under the paths specified in the environment variables.
